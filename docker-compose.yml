services:
  backend:
    build: ./backend
    container_name: deckpilot-backend
    ports:
      - "8000:8000"
    environment:
      SKYWORK_SECRET_ID: ${SKYWORK_SECRET_ID}
      SKYWORK_SECRET_KEY: ${SKYWORK_SECRET_KEY}
      SKYWORK_MCP_SSE_URL: ${SKYWORK_MCP_SSE_URL:-https://api.skywork.ai/open/sse}
    restart: unless-stopped

  webui-new:
    image: ghcr.io/open-webui/open-webui:main
    container_name: deckpilot-webui-new
    ports:
      - "3001:8080"   # âœ… æ”¹ä¸º 3001ï¼Œé¿å…å†²çª
    volumes:
      - openwebui-data-new:/app/backend/data
    environment:
      - OPENAI_API_BASE_URL=http://backend:8000/v1
      - OPENAI_API_KEY=debug-placeholder
      - OLLAMA_BASE_URL=http://ollama:11434
      # ğŸ‘‡ã€è¿™é‡Œæ˜¯æ–°å¢çš„ã€‘ğŸ‘‡
      # è®¾ç½®ä¸º 600 ç§’ (10åˆ†é’Ÿ)ï¼Œè¶³å¤Ÿè¦†ç›–ä½ åˆšæ‰çš„ 4åˆ†17ç§’
      - AIOHTTP_CLIENT_TIMEOUT=1200
      # å¦‚æœæœ‰ SSL é—®é¢˜ä¹Ÿå¯ä»¥åŠ ä¸Šè¿™ä¸ª
      - ENABLE_RAG_WEB_LOADER_SSL_VERIFICATION=false
    depends_on:
      - backend
    restart: unless-stopped

volumes:
  openwebui-data-new:
